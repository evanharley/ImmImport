## Introduction
This is a simple Python application for the import of Discipline size datasets into the 
Royal BC Museum's *Integrated Museum Management(IMM)* Collection Management System

## Application Description

### Overview

This is a simple class with methods to facilitate the import of Discipline data into IMM.
The run structure looks a bit like the following:

ImmImport() -> _write_to_*[write to method of choice]* -> *main()* -> _handle_spreadsheet() -> _handle_row() -> _write_query() -> _import()

### Class Structure

#### Class Attributes

##### root
This is just the parent window for the Tkinter fileDialog call later in the application.
	
##### self._connection
This is the pyodbc connection to the IMM database.
	
##### self._cursor
This is the cursor which allows interaction with the database on the other end of self._connection

#### Class Methods

##### main(): 
The main method is exactly what it says on the tin. It does the following:
1. Offers the user a folder selection dialog then iterates through the files in the folder
2. Calls the *self._handle_spreadsheet(sheet)* method for every spreadsheet in the directory
3. Commits the changes to the database

##### _handle_spreadsheet(sheet):
This method directs most of the work being done by the rest of the application.
It does the following:
1. Iterate through the tabs in the spreadsheet and for each tab does the following:
	1. calls the method *self._get_keys(sheet)* 
	2. For each row in the sheet's tab:
		1. Calls the *self._handle_row(row, keys)* method
		2. Calls the *self._write_query([output from the self._handle_row()])* method
		3. Calls the *self._import([output from the self.write_query()])* method
		4. Reports any Database Exceptions, and breaks the run in a controlled manner.
	
#### _handle_row(row, keys)
This method converts the openpyxl row to a dictionary in the form {column header (key): column value)
where the value in the row is not None, or and empty string.

#### _write_query(data, table)
This method takes the dictionary generated by the *handle_row* method and the name of the table that the
the data needs to be written to. From these two inputs it generates a query with which to write the row data
to the database table specified.

#### _import(query)
This method runs the query generated by *_write_query(data, table)* and handles any errors returned by the
*self.cursor.execute(query)* method

##### _get_keys(sheet)
This method takes the working sheet from the tab being worked with in the *self._handle_spreadsheet* method
and returns the column headers as a dictionary in the form {column number: header value}

##### _write_to_test()
This method changes which IMM database the application is connected to. IMM Test (or ImportTest) for testing
purposes. This is so that the collection manager can verify that the data looks as it should before import into 
the production instance of the database.

##### _write_to_prod()
This method changes which IMM database the application is connected to. It changes the connection to IMM Prod 
for imports into the production instance of the IMM database, after the collection manager has confirmed that the data 
looks as it should.	

